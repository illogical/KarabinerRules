{
  "description": "Caps leader -> choose layer -> launch apps",
  "manipulators": [
    {
      "type": "basic",
      "from": { "key_code": "caps_lock", "modifiers": { "optional": ["any"] } },
      "to": [
	      { "set_variable": { "name": "leader", "value": 1, "key_up_value": 0 } }
      ],
      "to_if_alone": [{ "key_code": "escape" }]
    },

    /* --- Mode Switch Keys --- */

    {
      "type": "basic",
      "from": { "key_code": "a", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "leader", "value": 1 }],
      "to": [{ "set_variable": { "name": "layer", "value": "apps" } },
      { "shell_command": "osascript -e 'display notification \"Apps Mode ON\" with title \"Karabiner\"'" }]
    },
    {
      "type": "basic",
      "from": { "key_code": "v", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "leader", "value": 1 }],
      "to": [{ "set_variable": { "name": "layer", "value": "vscode" } },
      { "shell_command": "osascript -e 'display notification \"VSCode Mode ON\" with title \"Karabiner\"'" }]
    },

    /* --- Apps Mode Keys --- */

    {
      "type": "basic",
      "from": { "key_code": "b", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "apps" }],
      "to": [
        { "software_function": { "open_application": { "bundle_identifier": "com.vivaldi.Vivaldi" } } },
        { "set_variable": { "name": "layer", "value": 0 } }
      ]
    },
    {
      "type": "basic",
      "from": { "key_code": "e", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "apps" }],
      "to": [
        { "software_function": { "open_application": { "bundle_identifier": "com.evernote.Evernote" } } },
        { "set_variable": { "name": "layer", "value": 0 } }
      ]
    },
    {
      "type": "basic",
      "from": { "key_code": "n", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "apps" }],
      "to": [
        { "software_function": { "open_application": { "bundle_identifier": "notion.id" } } },
        { "set_variable": { "name": "layer", "value": 0 } }
      ]
    },
    {
      "type": "basic",
      "from": { "key_code": "t", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "apps" }],
      "to": [
        { "software_function": { "open_application": { "bundle_identifier": "com.apple.Terminal" } } },
        { "set_variable": { "name": "layer", "value": 0 } }
      ]
    },
    {
      "type": "basic",
      "from": { "key_code": "v", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "apps" }],
      "to": [
        { "software_function": { "open_application": { "bundle_identifier": "com.microsoft.VSCode" } } },
        { "set_variable": { "name": "layer", "value": 0 } }
      ]
    },

     /* --- VSCode Mode Keys --- */

    {
      "type": "basic",
      "from": { "key_code": "left_arrow", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "vscode" }],
      "to": [
        { "key_code": "hyphen", "modifiers": ["control"] }
      ]
    },
    {
      "type": "basic",
      "from": { "key_code": "right_arrow", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "vscode" }],
      "to": [
        { "key_code": "hyphen", "modifiers": ["control", "shift"] }
      ]
    },
    { // Open Project/Folder Explorer
      "type": "basic",
      "from": { "key_code": "e", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "vscode" }],
      "to": [
        { "key_code": "e", "modifiers": ["command", "shift"] }
      ]
    },
    { // Search files
      "type": "basic",
      "from": { "key_code": "f", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "vscode" }],
      "to": [
        { "key_code": "p", "modifiers": ["command"] },
        { "set_variable": { "name": "layer", "value": 0 } }
      ]
    },
    { // Open Github Source control
      "type": "basic",
      "from": { "key_code": "g", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "vscode" }],
      "to": [
        { "key_code": "g", "modifiers": ["control", "shift"] }
      ]
    },
    { // Search settings
      "type": "basic",
      "from": { "key_code": "s", "modifiers": { "optional": ["any"] } },
      "conditions": [{ "type": "variable_if", "name": "layer", "value": "vscode" }],
      "to": [
        { "key_code": "p", "modifiers": ["command", "shift"] },
        { "set_variable": { "name": "layer", "value": 0 } }
      ]
    },

    /* --- Exit/Cancel Modes --- */

    {
      "type": "basic",
      "from": { "key_code": "escape", "modifiers": { "optional": ["any"] } },
      "conditions": [
        { "type": "variable_unless", "name": "layer", "value": 0 }
      ],
      "to": [
	      { "set_variable": { "name": "layer", "value": 0 } },
	      { "shell_command": "osascript -e 'display notification \"All Modes OFF\" with title \"Karabiner\"'" }
      ]
    }
  ]
}